<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (0)
 -->
<!-- Title: workflow Pages: 1 -->
<svg width="939pt" height="825pt"
 viewBox="0.00 0.00 939.39 825.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 821)">
<title>workflow</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-821 935.39,-821 935.39,4 -4,4"/>
<!-- Reference FASTA -->
<g id="node1" class="node">
<title>Reference FASTA</title>
<polygon fill="none" stroke="black" points="380.2,-619 335.9,-637 247.28,-637 202.97,-619 247.28,-601 335.9,-601 380.2,-619"/>
<text text-anchor="middle" x="291.59" y="-615.3" font-family="Times,serif" font-size="14.00">Reference FASTA</text>
</g>
<!-- Bismark -->
<g id="node8" class="node">
<title>Bismark</title>
<polygon fill="#d9d9d9" stroke="#d9d9d9" points="583.59,-457 391.38,-439 583.59,-421 775.8,-439 583.59,-457"/>
<text text-anchor="middle" x="583.59" y="-435.3" font-family="Times,serif" font-size="14.00">bismark &#45;1 &lt;read 1s&gt; &#45;2 &lt;read 2s&gt;</text>
</g>
<!-- Reference FASTA&#45;&gt;Bismark -->
<g id="edge11" class="edge">
<title>Reference FASTA&#45;&gt;Bismark</title>
<path fill="none" stroke="black" d="M338.27,-601.93C360.56,-594.72 387.73,-586.6 412.59,-581 466.06,-568.95 491.6,-597 534.59,-563 542.51,-556.73 562.66,-501.06 574.51,-466.8"/>
<polygon fill="black" stroke="black" points="577.96,-467.53 577.9,-456.93 571.34,-465.25 577.96,-467.53"/>
</g>
<!-- bwa&#45;meth -->
<g id="node10" class="node">
<title>bwa&#45;meth</title>
<polygon fill="#d9d9d9" stroke="#d9d9d9" points="186.59,-457 -0.09,-439 186.59,-421 373.27,-439 186.59,-457"/>
<text text-anchor="middle" x="186.59" y="-435.3" font-family="Times,serif" font-size="14.00">bwameth.py &lt;read 1s&gt; &lt;read 2s&gt;</text>
</g>
<!-- Reference FASTA&#45;&gt;bwa&#45;meth -->
<g id="edge12" class="edge">
<title>Reference FASTA&#45;&gt;bwa&#45;meth</title>
<path fill="none" stroke="black" d="M265.57,-600.71C244.13,-584.96 214.87,-559.67 199.59,-530 189.62,-510.64 186.62,-486.02 185.97,-467.42"/>
<polygon fill="black" stroke="black" points="189.47,-467.2 185.83,-457.25 182.47,-467.3 189.47,-467.2"/>
</g>
<!-- Bismark Index -->
<g id="node13" class="node">
<title>Bismark Index</title>
<ellipse fill="none" stroke="black" cx="447.59" cy="-512" rx="63.89" ry="18"/>
<text text-anchor="middle" x="447.59" y="-508.3" font-family="Times,serif" font-size="14.00">Bismark Index</text>
</g>
<!-- Reference FASTA&#45;&gt;Bismark Index -->
<g id="edge9" class="edge">
<title>Reference FASTA&#45;&gt;Bismark Index</title>
<path fill="none" stroke="black" d="M308.21,-600.88C323.64,-585.65 347.74,-563.46 371.59,-548 381.11,-541.83 391.89,-536.17 402.28,-531.27"/>
<polygon fill="black" stroke="black" points="404.01,-534.33 411.67,-527.01 401.12,-527.96 404.01,-534.33"/>
<text text-anchor="middle" x="453.09" y="-551.8" font-family="Times,serif" font-size="14.00">bismark_genome_preparation</text>
</g>
<!-- bwa&#45;meth Index -->
<g id="node14" class="node">
<title>bwa&#45;meth Index</title>
<ellipse fill="none" stroke="black" cx="277.59" cy="-512" rx="68.79" ry="18"/>
<text text-anchor="middle" x="277.59" y="-508.3" font-family="Times,serif" font-size="14.00">bwa&#45;meth Index</text>
</g>
<!-- Reference FASTA&#45;&gt;bwa&#45;meth Index -->
<g id="edge10" class="edge">
<title>Reference FASTA&#45;&gt;bwa&#45;meth Index</title>
<path fill="none" stroke="black" d="M272.14,-600.7C262.45,-590.76 251.73,-577.41 246.59,-563 243.46,-554.24 246.48,-545.39 251.67,-537.61"/>
<polygon fill="black" stroke="black" points="254.51,-539.67 257.97,-529.66 249.02,-535.33 254.51,-539.67"/>
<text text-anchor="middle" x="297.59" y="-551.8" font-family="Times,serif" font-size="14.00">bwameth.py index</text>
</g>
<!-- Input BAMs -->
<g id="node2" class="node">
<title>Input BAMs</title>
<polygon fill="none" stroke="black" points="659.17,-799 626.88,-817 562.3,-817 530,-799 562.3,-781 626.88,-781 659.17,-799"/>
<text text-anchor="middle" x="594.59" y="-795.3" font-family="Times,serif" font-size="14.00">Input BAMs</text>
</g>
<!-- Collated BAMs -->
<g id="node11" class="node">
<title>Collated BAMs</title>
<ellipse fill="none" stroke="black" cx="594.59" cy="-712" rx="66.89" ry="18"/>
<text text-anchor="middle" x="594.59" y="-708.3" font-family="Times,serif" font-size="14.00">Collated BAMs</text>
</g>
<!-- Input BAMs&#45;&gt;Collated BAMs -->
<g id="edge1" class="edge">
<title>Input BAMs&#45;&gt;Collated BAMs</title>
<path fill="none" stroke="black" d="M594.59,-780.8C594.59,-769.16 594.59,-753.55 594.59,-740.24"/>
<polygon fill="black" stroke="black" points="598.09,-740.18 594.59,-730.18 591.09,-740.18 598.09,-740.18"/>
<text text-anchor="middle" x="639.09" y="-751.8" font-family="Times,serif" font-size="14.00">samtools collate</text>
</g>
<!-- Input FASTQs -->
<g id="node3" class="node">
<title>Input FASTQs</title>
<polygon fill="none" stroke="black" points="931.18,-619 894.89,-637 822.29,-637 785.99,-619 822.29,-601 894.89,-601 931.18,-619"/>
<text text-anchor="middle" x="858.59" y="-615.3" font-family="Times,serif" font-size="14.00">Input FASTQs</text>
</g>
<!-- FASTQs -->
<g id="node12" class="node">
<title>FASTQs</title>
<ellipse fill="none" stroke="black" cx="618.59" cy="-512" rx="42.49" ry="18"/>
<text text-anchor="middle" x="618.59" y="-508.3" font-family="Times,serif" font-size="14.00">FASTQs</text>
</g>
<!-- Input FASTQs&#45;&gt;FASTQs -->
<g id="edge4" class="edge">
<title>Input FASTQs&#45;&gt;FASTQs</title>
<path fill="none" stroke="black" d="M821.5,-601.1C807.46,-594.74 791.31,-587.49 776.59,-581 735.85,-563.04 688.98,-542.94 656.93,-529.28"/>
<polygon fill="black" stroke="black" points="658.06,-525.96 647.49,-525.26 655.31,-532.4 658.06,-525.96"/>
</g>
<!-- Final Bismark BAMs -->
<g id="node4" class="node">
<title>Final Bismark BAMs</title>
<polygon fill="none" stroke="black" points="712.38,-123 507.5,-123 454.8,-87 659.68,-87 712.38,-123"/>
<text text-anchor="middle" x="583.59" y="-101.3" font-family="Times,serif" font-size="14.00">Final Bismark BAMs</text>
</g>
<!-- Bismark BAM Indices -->
<g id="node5" class="node">
<title>Bismark BAM Indices</title>
<polygon fill="none" stroke="black" points="717.82,-36 504.29,-36 449.36,0 662.89,0 717.82,-36"/>
<text text-anchor="middle" x="583.59" y="-14.3" font-family="Times,serif" font-size="14.00">Bismark BAM Indices</text>
</g>
<!-- Final Bismark BAMs&#45;&gt;Bismark BAM Indices -->
<g id="edge17" class="edge">
<title>Final Bismark BAMs&#45;&gt;Bismark BAM Indices</title>
<path fill="none" stroke="black" d="M583.59,-86.8C583.59,-75.16 583.59,-59.55 583.59,-46.24"/>
<polygon fill="black" stroke="black" points="587.09,-46.18 583.59,-36.18 580.09,-46.18 587.09,-46.18"/>
<text text-anchor="middle" x="625.09" y="-57.8" font-family="Times,serif" font-size="14.00">samtools index</text>
</g>
<!-- Final bwa&#45;meth BAMs -->
<g id="node6" class="node">
<title>Final bwa&#45;meth BAMs</title>
<polygon fill="none" stroke="black" points="322.63,-297 106.22,-297 50.55,-261 266.96,-261 322.63,-297"/>
<text text-anchor="middle" x="186.59" y="-275.3" font-family="Times,serif" font-size="14.00">Final bwa&#45;meth BAMs</text>
</g>
<!-- bwa&#45;meth BAM Indices -->
<g id="node7" class="node">
<title>bwa&#45;meth BAM Indices</title>
<polygon fill="none" stroke="black" points="328.56,-210 102.71,-210 44.61,-174 270.46,-174 328.56,-210"/>
<text text-anchor="middle" x="186.59" y="-188.3" font-family="Times,serif" font-size="14.00">bwa&#45;meth BAM Indices</text>
</g>
<!-- Final bwa&#45;meth BAMs&#45;&gt;bwa&#45;meth BAM Indices -->
<g id="edge20" class="edge">
<title>Final bwa&#45;meth BAMs&#45;&gt;bwa&#45;meth BAM Indices</title>
<path fill="none" stroke="black" d="M186.59,-260.8C186.59,-249.16 186.59,-233.55 186.59,-220.24"/>
<polygon fill="black" stroke="black" points="190.09,-220.18 186.59,-210.18 183.09,-220.18 190.09,-220.18"/>
<text text-anchor="middle" x="228.09" y="-231.8" font-family="Times,serif" font-size="14.00">samtools index</text>
</g>
<!-- Realigned Bismark BAMs (no @RG) -->
<g id="node15" class="node">
<title>Realigned Bismark BAMs (no @RG)</title>
<ellipse fill="none" stroke="black" cx="583.59" cy="-366" rx="145.67" ry="18"/>
<text text-anchor="middle" x="583.59" y="-362.3" font-family="Times,serif" font-size="14.00">Realigned Bismark BAMs (no @RG)</text>
</g>
<!-- Bismark&#45;&gt;Realigned Bismark BAMs (no @RG) -->
<g id="edge13" class="edge">
<title>Bismark&#45;&gt;Realigned Bismark BAMs (no @RG)</title>
<path fill="none" stroke="black" d="M583.59,-420.81C583.59,-412.79 583.59,-403.05 583.59,-394.07"/>
<polygon fill="black" stroke="black" points="587.09,-394.03 583.59,-384.03 580.09,-394.03 587.09,-394.03"/>
</g>
<!-- samtools fastq -->
<g id="node9" class="node">
<title>samtools fastq</title>
<polygon fill="#d9d9d9" stroke="#d9d9d9" points="594.59,-657 421.59,-619 594.59,-581 767.59,-619 594.59,-657"/>
<text text-anchor="middle" x="594.59" y="-622.8" font-family="Times,serif" font-size="14.00">samtools fastq &#45;1 &lt;read 1s&gt; </text>
<text text-anchor="middle" x="594.59" y="-607.8" font-family="Times,serif" font-size="14.00">&#45;2 &lt;read 2s&gt; &lt;BAM file&gt;</text>
</g>
<!-- samtools fastq&#45;&gt;FASTQs -->
<g id="edge3" class="edge">
<title>samtools fastq&#45;&gt;FASTQs</title>
<path fill="none" stroke="black" d="M602.65,-582.74C605.85,-568.74 609.47,-552.88 612.45,-539.84"/>
<polygon fill="black" stroke="black" points="615.87,-540.59 614.69,-530.06 609.05,-539.03 615.87,-540.59"/>
</g>
<!-- Realigned bwa&#45;meth BAMs -->
<g id="node18" class="node">
<title>Realigned bwa&#45;meth BAMs</title>
<ellipse fill="none" stroke="black" cx="186.59" cy="-366" rx="110.48" ry="18"/>
<text text-anchor="middle" x="186.59" y="-362.3" font-family="Times,serif" font-size="14.00">Realigned bwa&#45;meth BAMs</text>
</g>
<!-- bwa&#45;meth&#45;&gt;Realigned bwa&#45;meth BAMs -->
<g id="edge18" class="edge">
<title>bwa&#45;meth&#45;&gt;Realigned bwa&#45;meth BAMs</title>
<path fill="none" stroke="black" d="M186.59,-420.81C186.59,-412.79 186.59,-403.05 186.59,-394.07"/>
<polygon fill="black" stroke="black" points="190.09,-394.03 186.59,-384.03 183.09,-394.03 190.09,-394.03"/>
</g>
<!-- Collated BAMs&#45;&gt;samtools fastq -->
<g id="edge2" class="edge">
<title>Collated BAMs&#45;&gt;samtools fastq</title>
<path fill="none" stroke="black" d="M594.59,-693.88C594.59,-686.25 594.59,-676.83 594.59,-667.31"/>
<polygon fill="black" stroke="black" points="598.09,-667.02 594.59,-657.02 591.09,-667.02 598.09,-667.02"/>
</g>
<!-- FASTQs&#45;&gt;Bismark -->
<g id="edge5" class="edge">
<title>FASTQs&#45;&gt;Bismark</title>
<path fill="none" stroke="black" d="M610.29,-494.17C606.11,-485.69 600.94,-475.21 596.27,-465.73"/>
<polygon fill="black" stroke="black" points="599.38,-464.13 591.82,-456.71 593.11,-467.22 599.38,-464.13"/>
</g>
<!-- FASTQs&#45;&gt;bwa&#45;meth -->
<g id="edge6" class="edge">
<title>FASTQs&#45;&gt;bwa&#45;meth</title>
<path fill="none" stroke="black" d="M579.97,-504.2C561.94,-501.05 540.17,-497.28 520.59,-494 432.56,-479.25 331.36,-462.99 263.64,-452.2"/>
<polygon fill="black" stroke="black" points="263.91,-448.7 253.48,-450.58 262.81,-455.61 263.91,-448.7"/>
</g>
<!-- Bismark Index&#45;&gt;Bismark -->
<g id="edge7" class="edge">
<title>Bismark Index&#45;&gt;Bismark</title>
<path fill="none" stroke="black" d="M476.43,-495.94C496.9,-485.26 524.55,-470.82 546.63,-459.29"/>
<polygon fill="black" stroke="black" points="548.47,-462.28 555.72,-454.55 545.23,-456.08 548.47,-462.28"/>
</g>
<!-- bwa&#45;meth Index&#45;&gt;bwa&#45;meth -->
<g id="edge8" class="edge">
<title>bwa&#45;meth Index&#45;&gt;bwa&#45;meth</title>
<path fill="none" stroke="black" d="M256.48,-494.53C243.87,-484.69 227.72,-472.09 214.11,-461.47"/>
<polygon fill="black" stroke="black" points="216.06,-458.56 206.03,-455.17 211.76,-464.08 216.06,-458.56"/>
</g>
<!-- Realigned Bismark BAMs (with @RG) -->
<g id="node16" class="node">
<title>Realigned Bismark BAMs (with @RG)</title>
<ellipse fill="none" stroke="black" cx="583.59" cy="-279" rx="152.17" ry="18"/>
<text text-anchor="middle" x="583.59" y="-275.3" font-family="Times,serif" font-size="14.00">Realigned Bismark BAMs (with @RG)</text>
</g>
<!-- Realigned Bismark BAMs (no @RG)&#45;&gt;Realigned Bismark BAMs (with @RG) -->
<g id="edge14" class="edge">
<title>Realigned Bismark BAMs (no @RG)&#45;&gt;Realigned Bismark BAMs (with @RG)</title>
<path fill="none" stroke="black" d="M583.59,-347.8C583.59,-336.16 583.59,-320.55 583.59,-307.24"/>
<polygon fill="black" stroke="black" points="587.09,-307.18 583.59,-297.18 580.09,-307.18 587.09,-307.18"/>
<text text-anchor="middle" x="645.09" y="-318.8" font-family="Times,serif" font-size="14.00">samtools addreplacerg</text>
</g>
<!-- Sorted Bismark BAMs -->
<g id="node17" class="node">
<title>Sorted Bismark BAMs</title>
<ellipse fill="none" stroke="black" cx="583.59" cy="-192" rx="92.88" ry="18"/>
<text text-anchor="middle" x="583.59" y="-188.3" font-family="Times,serif" font-size="14.00">Sorted Bismark BAMs</text>
</g>
<!-- Realigned Bismark BAMs (with @RG)&#45;&gt;Sorted Bismark BAMs -->
<g id="edge15" class="edge">
<title>Realigned Bismark BAMs (with @RG)&#45;&gt;Sorted Bismark BAMs</title>
<path fill="none" stroke="black" d="M583.59,-260.8C583.59,-249.16 583.59,-233.55 583.59,-220.24"/>
<polygon fill="black" stroke="black" points="587.09,-220.18 583.59,-210.18 580.09,-220.18 587.09,-220.18"/>
<text text-anchor="middle" x="620.09" y="-231.8" font-family="Times,serif" font-size="14.00">samtools sort</text>
</g>
<!-- Sorted Bismark BAMs&#45;&gt;Final Bismark BAMs -->
<g id="edge16" class="edge">
<title>Sorted Bismark BAMs&#45;&gt;Final Bismark BAMs</title>
<path fill="none" stroke="black" d="M583.59,-173.8C583.59,-162.16 583.59,-146.55 583.59,-133.24"/>
<polygon fill="black" stroke="black" points="587.09,-133.18 583.59,-123.18 580.09,-133.18 587.09,-133.18"/>
<text text-anchor="middle" x="640.59" y="-144.8" font-family="Times,serif" font-size="14.00">deduplicate_bismark</text>
</g>
<!-- Realigned bwa&#45;meth BAMs&#45;&gt;Final bwa&#45;meth BAMs -->
<g id="edge19" class="edge">
<title>Realigned bwa&#45;meth BAMs&#45;&gt;Final bwa&#45;meth BAMs</title>
<path fill="none" stroke="black" d="M186.59,-347.8C186.59,-336.16 186.59,-320.55 186.59,-307.24"/>
<polygon fill="black" stroke="black" points="190.09,-307.18 186.59,-297.18 183.09,-307.18 190.09,-307.18"/>
<text text-anchor="middle" x="223.09" y="-318.8" font-family="Times,serif" font-size="14.00">samtools sort</text>
</g>
</g>
</svg>
