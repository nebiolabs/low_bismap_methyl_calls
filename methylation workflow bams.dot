digraph workflow {

	"grch38 fasta" [shape=hexagon, label="grch38 fasta"];

	"Bismap complete bedGraph";

	"PREPROC_1" -> "Bismap complete bedGraph" [label="from preprocessing", style=dotted];

	"PREPROC_1" [style=invis];

	"Bismap complete bedGraph" -> "MethylDackel extract -@ 16 -q <cutoff>\n--CHH --CHG --OT 2,0,0,97_2" [label="Bismap"];

	"Methylation sequencing reads" [shape=hexagon];

	"Methylation sequencing reads" -> "sorted alignment BAM" [label="aligner"];

	"MapQ cutoff" [shape=hexagon];

	"MapQ cutoff" -> "MethylDackel extract -@ 16 -q <cutoff>\n--CHH --CHG --OT 2,0,0,97_2" [label="cutoff"];

	"grch38 fasta" -> "MethylDackel extract -@ 16 -q <cutoff>\n--CHH --CHG --OT 2,0,0,97_2";

	"sort -k1,1 -k2,2n_2" [shape=diamond,  color=gray85, style=filled, label="sort -k1,1 -k2,2n"];
	"sort -k1,1 -k2,2n_2" -> "sorted bedGraph";
	"sorted bedGraph" -> "sorted bedGraph\n(no headers)" [label="head -n -3"];
	"CpG" -> "sort -k1,1 -k2,2n_2";
	"CHG" -> "sort -k1,1 -k2,2n_2" ;
	"CHH" -> "sort -k1,1 -k2,2n_2";
	"MethylDackel extract -@ 16 -q <cutoff>\n--CHH --CHG --OT 2,0,0,97_2" [shape=diamond,  color=gray85, style=filled, label="MethylDackel extract -@ 16 -m <Bismap> \n-q <cutoff> --CHH --CHG --OT 2,0,0,97"];
	"sorted alignment BAM" -> "MethylDackel extract -@ 16 -q <cutoff>\n--CHH --CHG --OT 2,0,0,97_2";
	"MethylDackel extract -@ 16 -q <cutoff>\n--CHH --CHG --OT 2,0,0,97_2" -> "CHG";
	"MethylDackel extract -@ 16 -q <cutoff>\n--CHH --CHG --OT 2,0,0,97_2" -> "CpG";
	"MethylDackel extract -@ 16 -q <cutoff>\n--CHH --CHG --OT 2,0,0,97_2" -> "CHH";
	"sorted bedGraph\n(no headers)" -> "bedtools intersect -u_2" [label="methyl calls"];

	"sorted low mappability regions\nin ClinVar annotations 2" [label="sorted low mappability regions\nin ClinVar annotations"];

	"PREPROC_2" -> "sorted low mappability regions\nin ClinVar annotations 2" [label="from preprocessing", style=dotted];

	"PREPROC_2" [style=invis];

	"sorted low mappability regions\nin ClinVar annotations 2" -> "bedtools intersect -u_2" [label="low map. regions"];

	"sorted low mappability ClinVar regions 2" [label="sorted low mappability ClinVar regions"];

	"PREPROC_3" -> "sorted low mappability ClinVar regions 2" [label="from preprocessing", style=dotted];

	"PREPROC_3" [style=invis];

	"sorted low mappability ClinVar regions 2" -> "bedtools intersect -u_3b" [label="ClinVar low map."];

	"bedtools intersect -u_2" [label="bedtools intersect -u -sorted \n-a <methyl calls> -b <low map. regions>", shape=diamond,  color=gray85, style=filled];

	"bedtools intersect -u_2" -> "methylation calls in low\nmappability regions in ClinVar regions\n(i.e. miscalls)";

 	"bedtools intersect -u_3b" [shape=diamond,  color=gray85, style=filled, label="bedtools intersect -wa -sorted \n-a <ClinVar low map.> -b <miscalls>"];

	"methylation calls in low\nmappability regions in ClinVar regions\n(i.e. miscalls)" -> "bedtools intersect -u_3b" [label="miscalls"];
	
	"bedtools intersect -u_3b" -> "ClinVar regions for each methylation miscall";

	"ClinVar regions for each methylation miscall" -> "ClinVar regions with count of methylation miscalls" [label="count_miscalls.py"];

	"methylation miscall data" [shape=box, color=gray, style=filled];

	"awk \'{ print $0\"\\t<aligner>\" }\'" [shape=diamond,  color=gray85, style=filled];


	"methylation calls in low\nmappability regions in ClinVar regions\n(i.e. miscalls)" -> "awk \'{ print $0\"\\t<aligner>\" }\'";



	"awk \'{ print $0\"\\t<aligner>\" }\'" -> "methylation calls in low\nmappability regions in ClinVar regions\nwith identifier column";




	"methylation calls in low\nmappability regions in ClinVar regions\nwith identifier column" -> "methylation miscall data" [style=dashed, label="Display in Tableau"]

	"methylation miscall data" [shape=parallelogram];

	"ClinVar regions with count of methylation miscalls" [shape=parallelogram];

	#"ClinVar regions with methylation miscalls" -> "Examine Data" [style=invis];

	#"bismark vs. bwameth\nmethylation miscall comparison" -> "Examine Data" [style=invis];

	


	
 }