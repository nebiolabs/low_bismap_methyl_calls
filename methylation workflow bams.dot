digraph workflow {

	"ref fasta" [shape=hexagon, label="ref FASTA"];

	"mass mapping CSV" [shape=hexagon, label="BAM name->mass mapping CSV"];

	"Bismap complete bedGraph";

	"PREPROC_1" -> "Bismap complete bedGraph" [label="from preprocessing", style=dotted];

	"PREPROC_1" [style=invis];

	"Bismap complete bedGraph" -> "MethylDackel extract -@ 16 -q <cutoff>\n--CHH --CHG --OT 2,0,0,97_2" [label="Bismap"];

	"Methylation sequencing reads" [shape=hexagon];

	"Methylation sequencing reads" -> "sorted alignment BAM" [label="aligner"];

	"MapQ cutoff" [shape=hexagon];

	"MapQ cutoff" -> "MethylDackel extract -@ 16 -q <cutoff>\n--CHH --CHG --OT 2,0,0,97_2" [label="cutoff"];

	"ref fasta" -> "MethylDackel extract -@ 16 -q <cutoff>\n--CHH --CHG --OT 2,0,0,97_2";

	"sort -k1,1 -k2,2n_2" [shape=diamond,  color=gray85, style=filled, label="sort -k1,1 -k2,2n"];
	"sort -k1,1 -k2,2n_2" -> "sorted bedGraph";
	"sorted bedGraph" -> "sorted bedGraph\n(no headers)" [label="head -n -3"];
	"CpG" -> "sort -k1,1 -k2,2n_2";
	"CHG" -> "sort -k1,1 -k2,2n_2" ;
	"CHH" -> "sort -k1,1 -k2,2n_2";
	"MethylDackel extract -@ 16 -q <cutoff>\n--CHH --CHG --OT 2,0,0,97_2" [shape=diamond,  color=gray85, style=filled, label="MethylDackel extract -@ 16 -m <Bismap> \n-q <cutoff> --CHH --CHG --OT 2,0,0,97"];
	"sorted alignment BAM" -> "MethylDackel extract -@ 16 -q <cutoff>\n--CHH --CHG --OT 2,0,0,97_2";
	"MethylDackel extract -@ 16 -q <cutoff>\n--CHH --CHG --OT 2,0,0,97_2" -> "CHG";
	"MethylDackel extract -@ 16 -q <cutoff>\n--CHH --CHG --OT 2,0,0,97_2" -> "CpG";
	"MethylDackel extract -@ 16 -q <cutoff>\n--CHH --CHG --OT 2,0,0,97_2" -> "CHH";
	"sorted bedGraph\n(no headers)" -> "bedtools intersect -u_2" [label="methyl calls"];

	"sorted low mappability regions\nin ClinVar annotations 2" [label="sorted low mappability regions\nin ClinVar annotations"];

	"PREPROC_2" -> "sorted low mappability regions\nin ClinVar annotations 2" [label="from preprocessing", style=dotted];

	"PREPROC_2" [style=invis];

	"sorted low mappability regions\nin ClinVar annotations 2" -> "bedtools intersect -u_2" [label="low map. regions"];

	"sorted low mappability ClinVar regions 2" [label="sorted low mappability ClinVar regions"];

	"PREPROC_3" -> "sorted low mappability ClinVar regions 2" [label="from preprocessing", style=dotted];

	"PREPROC_3" [style=invis];

	"sorted low mappability ClinVar regions 2" -> "bedtools intersect -u_3b" [label="ClinVar low map."];

	"bedtools intersect -u_2" [label="bedtools intersect -u -sorted \n-a <methyl calls> -b <low map. regions>", shape=diamond,  color=gray85, style=filled];

	"bedtools intersect -u_2" -> "methylation calls in low\nmappability regions in ClinVar regions";

 	"bedtools intersect -u_3b" [shape=diamond,  color=gray85, style=filled, label="bedtools intersect -wa -sorted \n-a <ClinVar low map.> -b <low map. calls>"];

	"methylation calls in low\nmappability regions in ClinVar regions" -> "bedtools intersect -u_3b" [label="low map. calls"];
	
	"bedtools intersect -u_3b" -> "ClinVar regions for each low-mappability methyl call";

	"add_params_1" [shape=diamond,  color=gray85, style=filled, label="python add_params.py"];

	"add_params_2" [shape=diamond,  color=gray85, style=filled, label="python add_params.py"];

	"ClinVar regions for each low-mappability methyl call" -> "add_params_1";

	"add_params_1" -> "ClinVar regions for each low-mappability methyl\n call with identifier columns";

	"ClinVar regions for each low-mappability methyl\n call with identifier columns" -> "ClinVar regions with count \nof low-mappability methyl calls" [label="count_low_map_calls"];

	"low-mappability methyl call data" [shape=box, color=gray, style=filled];


	"mass mapping CSV" -> "add_params_1";


	"mass mapping CSV" -> "add_params_2";

	"methylation calls in low\nmappability regions in ClinVar regions" -> "add_params_2";
	
	"add_params_2" -> "methylation calls in low\nmappability regions in ClinVar regions\nwith identifier columns";



	"methylation calls in low\nmappability regions in ClinVar regions\nwith identifier columns" -> "low-mappability methyl call data" [style=dashed, label="Display in Tableau"]

	"low-mappability methyl call data" [shape=parallelogram];

	"ClinVar regions with count \nof low-mappability methyl calls" [shape=parallelogram];

	#"ClinVar regions with low-mappability methyl calls" -> "Examine Data" [style=invis];

	#"bismark vs. bwameth\nlow-mappability methyl call comparison" -> "Examine Data" [style=invis];

	


	
 }